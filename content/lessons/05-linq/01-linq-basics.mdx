---
title: "LINQ Basics"
description: "Learn the fundamentals of Language Integrated Query (LINQ)"
order: 1
difficulty: "intermediate"
tags: ["linq", "query", "data manipulation", "collections"]
duration: "30 minutes"
---

# LINQ Basics

LINQ (Language Integrated Query) is a powerful feature that adds query capabilities directly into C#. It provides a consistent way to query data from various sources.

## What is LINQ?

LINQ allows you to write queries against collections, databases, XML, and more using a unified syntax. It makes data manipulation expressive and readable.

## Getting Started with LINQ

<CodeEditor 
  initialCode={`using System;
using System.Linq;
using System.Collections.Generic;

class Program
{
    static void Main()
    {
        var numbers = new List<int> { 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 };
        
        Console.WriteLine($"Original: {string.Join(", ", numbers)}");
        
        // Method syntax (fluent)
        var evenNumbers = numbers.Where(n => n % 2 == 0);
        Console.WriteLine($"Evens (method): {string.Join(", ", evenNumbers)}");
        
        // Query syntax (SQL-like)
        var evenQuery = from n in numbers
                        where n % 2 == 0
                        select n;
        Console.WriteLine($"Evens (query): {string.Join(", ", evenQuery)}");
        
        // Both produce the same result!
        // Method syntax is more common in practice
    }
}`}
/>

## Basic LINQ Operations

### Where - Filtering

<CodeEditor 
  initialCode={`using System;
using System.Linq;
using System.Collections.Generic;

class Program
{
    static void Main()
    {
        var numbers = Enumerable.Range(1, 20).ToList();
        
        Console.WriteLine($"All: {string.Join(", ", numbers)}");
        
        // Single condition
        var evens = numbers.Where(n => n % 2 == 0);
        Console.WriteLine($"Evens: {string.Join(", ", evens)}");
        
        // Multiple conditions
        var evenAndBigger = numbers.Where(n => n % 2 == 0 && n > 10);
        Console.WriteLine($"Even and > 10: {string.Join(", ", evenAndBigger)}");
        
        // With index
        var evenIndex = numbers.Where((n, index) => index % 2 == 0);
        Console.WriteLine($"Even index: {string.Join(", ", evenIndex)}");
        
        // Chained Where (AND logic)
        var filtered = numbers
            .Where(n => n > 5)
            .Where(n => n < 15)
            .Where(n => n % 3 == 0);
        Console.WriteLine($"5 < n < 15, div by 3: {string.Join(", ", filtered)}");
    }
}`}
/>

### Select - Transforming

<CodeEditor 
  initialCode={`using System;
using System.Linq;
using System.Collections.Generic;

class Program
{
    static void Main()
    {
        var numbers = new List<int> { 1, 2, 3, 4, 5 };
        
        // Simple transformation
        var doubled = numbers.Select(n => n * 2);
        Console.WriteLine($"Doubled: {string.Join(", ", doubled)}");
        
        var squared = numbers.Select(n => n * n);
        Console.WriteLine($"Squared: {string.Join(", ", squared)}");
        
        // Transform to different type
        var asStrings = numbers.Select(n => $"Number: {n}");
        Console.WriteLine($"Strings: {string.Join(", ", asStrings)}");
        
        // Select with index
        var withIndex = numbers.Select((n, i) => $"[{i}]={n}");
        Console.WriteLine($"With index: {string.Join(", ", withIndex)}");
        
        // Select to anonymous type
        var objects = numbers.Select(n => new { Value = n, Square = n * n, IsEven = n % 2 == 0 });
        Console.WriteLine("\\nAs objects:");
        foreach (var obj in objects)
        {
            Console.WriteLine($"  {obj.Value}: square={obj.Square}, even={obj.IsEven}");
        }
    }
}`}
/>

### OrderBy / OrderByDescending - Sorting

<CodeEditor 
  initialCode={`using System;
using System.Linq;
using System.Collections.Generic;

class Person
{
    public string Name { get; set; }
    public int Age { get; set; }
    public string City { get; set; }
}

class Program
{
    static void Main()
    {
        var numbers = new List<int> { 5, 2, 8, 1, 9, 3, 7 };
        
        // Simple sorting
        var ascending = numbers.OrderBy(n => n);
        Console.WriteLine($"Ascending: {string.Join(", ", ascending)}");
        
        var descending = numbers.OrderByDescending(n => n);
        Console.WriteLine($"Descending: {string.Join(", ", descending)}");
        
        // Sorting objects
        var people = new List<Person>
        {
            new Person { Name = "Charlie", Age = 35, City = "NYC" },
            new Person { Name = "Alice", Age = 25, City = "LA" },
            new Person { Name = "Bob", Age = 30, City = "NYC" },
            new Person { Name = "Diana", Age = 25, City = "Chicago" }
        };
        
        Console.WriteLine("\\nBy Name:");
        foreach (var p in people.OrderBy(p => p.Name))
        {
            Console.WriteLine($"  {p.Name}");
        }
        
        Console.WriteLine("\\nBy Age (descending):");
        foreach (var p in people.OrderByDescending(p => p.Age))
        {
            Console.WriteLine($"  {p.Name}: {p.Age}");
        }
        
        // Multiple sort criteria with ThenBy
        Console.WriteLine("\\nBy Age, then by Name:");
        var sorted = people
            .OrderBy(p => p.Age)
            .ThenBy(p => p.Name);
        
        foreach (var p in sorted)
        {
            Console.WriteLine($"  {p.Name}: {p.Age}");
        }
    }
}`}
/>

### First, Last, Single

<CodeEditor 
  initialCode={`using System;
using System.Linq;
using System.Collections.Generic;

class Program
{
    static void Main()
    {
        var numbers = new List<int> { 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 };
        
        // First - get first element
        var first = numbers.First();
        var firstEven = numbers.First(n => n % 2 == 0);
        Console.WriteLine($"First: {first}");
        Console.WriteLine($"First even: {firstEven}");
        
        // Last - get last element
        var last = numbers.Last();
        var lastEven = numbers.Last(n => n % 2 == 0);
        Console.WriteLine($"Last: {last}");
        Console.WriteLine($"Last even: {lastEven}");
        
        // Single - expects exactly one match
        var theFive = numbers.Single(n => n == 5);
        Console.WriteLine($"The five: {theFive}");
        
        // OrDefault variants - return default if not found
        var empty = new List<int>();
        var firstOrDefault = empty.FirstOrDefault();  // Returns 0
        Console.WriteLine($"FirstOrDefault on empty: {firstOrDefault}");
        
        var notFound = numbers.FirstOrDefault(n => n > 100);
        Console.WriteLine($"First > 100: {notFound}");  // Returns 0
        
        var singleOrDefault = numbers.SingleOrDefault(n => n > 100);
        Console.WriteLine($"Single > 100: {singleOrDefault}");  // Returns 0
        
        // With custom default (C# 9+)
        // var result = numbers.FirstOrDefault(n => n > 100, -1);
    }
}`}
/>

### Take and Skip

<CodeEditor 
  initialCode={`using System;
using System.Linq;
using System.Collections.Generic;

class Program
{
    static void Main()
    {
        var numbers = Enumerable.Range(1, 10).ToList();
        Console.WriteLine($"All: {string.Join(", ", numbers)}");
        
        // Take - get first N elements
        var firstThree = numbers.Take(3);
        Console.WriteLine($"Take 3: {string.Join(", ", firstThree)}");
        
        // Skip - skip first N elements
        var skipThree = numbers.Skip(3);
        Console.WriteLine($"Skip 3: {string.Join(", ", skipThree)}");
        
        // Pagination
        int pageSize = 3;
        int pageNumber = 2;  // 0-indexed
        var page = numbers
            .Skip(pageNumber * pageSize)
            .Take(pageSize);
        Console.WriteLine($"Page {pageNumber + 1}: {string.Join(", ", page)}");
        
        // TakeWhile - take while condition is true
        var takeWhile = numbers.TakeWhile(n => n < 5);
        Console.WriteLine($"TakeWhile < 5: {string.Join(", ", takeWhile)}");
        
        // SkipWhile - skip while condition is true
        var skipWhile = numbers.SkipWhile(n => n < 5);
        Console.WriteLine($"SkipWhile < 5: {string.Join(", ", skipWhile)}");
        
        // TakeLast / SkipLast
        var lastThree = numbers.TakeLast(3);
        Console.WriteLine($"TakeLast 3: {string.Join(", ", lastThree)}");
        
        var skipLastThree = numbers.SkipLast(3);
        Console.WriteLine($"SkipLast 3: {string.Join(", ", skipLastThree)}");
    }
}`}
/>

### Aggregation: Count, Sum, Average, Min, Max

<CodeEditor 
  initialCode={`using System;
using System.Linq;
using System.Collections.Generic;

class Product
{
    public string Name { get; set; }
    public decimal Price { get; set; }
    public int Stock { get; set; }
}

class Program
{
    static void Main()
    {
        var numbers = new List<int> { 5, 10, 15, 20, 25 };
        
        Console.WriteLine("=== Number Aggregations ===");
        Console.WriteLine($"Count: {numbers.Count}");
        Console.WriteLine($"Sum: {numbers.Sum()}");
        Console.WriteLine($"Average: {numbers.Average()}");
        Console.WriteLine($"Min: {numbers.Min()}");
        Console.WriteLine($"Max: {numbers.Max()}");
        
        // With predicate
        Console.WriteLine($"Count > 10: {numbers.Count(n => n > 10)}");
        Console.WriteLine($"Sum of evens: {numbers.Where(n => n % 2 == 0).Sum()}");
        
        var products = new List<Product>
        {
            new Product { Name = "Laptop", Price = 999.99m, Stock = 10 },
            new Product { Name = "Mouse", Price = 29.99m, Stock = 50 },
            new Product { Name = "Keyboard", Price = 79.99m, Stock = 30 },
            new Product { Name = "Monitor", Price = 299.99m, Stock = 15 }
        };
        
        Console.WriteLine("\\n=== Product Aggregations ===");
        Console.WriteLine($"Total products: {products.Count}");
        Console.WriteLine($"Total stock: {products.Sum(p => p.Stock)}");
        Console.WriteLine($"Average price: \\${'{'}products.Average(p => p.Price):F2{'}'}");
        Console.WriteLine($"Cheapest: \\${'{'}products.Min(p => p.Price){'}'}");
        Console.WriteLine($"Most expensive: \\${'{'}products.Max(p => p.Price){'}'}");
        
        // Find the actual object with min/max
        var cheapest = products.OrderBy(p => p.Price).First();
        var expensive = products.OrderByDescending(p => p.Price).First();
        Console.WriteLine($"\\nCheapest product: {cheapest.Name} (\\${'{'}cheapest.Price{'}'})");
        Console.WriteLine($"Most expensive: {expensive.Name} (\\${'{'}expensive.Price{'}'})");
        
        // Total inventory value
        var totalValue = products.Sum(p => p.Price * p.Stock);
        Console.WriteLine($"Total inventory value: \\${'{'}totalValue:F2{'}'}");
    }
}`}
/>

### Any and All

<CodeEditor 
  initialCode={`using System;
using System.Linq;
using System.Collections.Generic;

class Student
{
    public string Name { get; set; }
    public int Age { get; set; }
    public List<int> Grades { get; set; }
}

class Program
{
    static void Main()
    {
        var numbers = new List<int> { 1, 2, 3, 4, 5 };
        
        // Any - checks if any element matches
        Console.WriteLine("=== Any ===");
        Console.WriteLine($"Any elements? {numbers.Any()}");
        Console.WriteLine($"Any even? {numbers.Any(n => n % 2 == 0)}");
        Console.WriteLine($"Any > 10? {numbers.Any(n => n > 10)}");
        
        // All - checks if all elements match
        Console.WriteLine("\\n=== All ===");
        Console.WriteLine($"All positive? {numbers.All(n => n > 0)}");
        Console.WriteLine($"All < 10? {numbers.All(n => n < 10)}");
        Console.WriteLine($"All even? {numbers.All(n => n % 2 == 0)}");
        
        // Practical example
        var students = new List<Student>
        {
            new Student { Name = "Alice", Age = 20, Grades = new List<int> { 85, 90, 88 } },
            new Student { Name = "Bob", Age = 22, Grades = new List<int> { 70, 75, 68 } },
            new Student { Name = "Charlie", Age = 19, Grades = new List<int> { 95, 92, 98 } }
        };
        
        Console.WriteLine("\\n=== Student Checks ===");
        
        // Any student with perfect score?
        bool hasPerfectScore = students.Any(s => s.Grades.Any(g => g == 100));
        Console.WriteLine($"Any perfect score? {hasPerfectScore}");
        
        // All students passing (average >= 70)?
        bool allPassing = students.All(s => s.Grades.Average() >= 70);
        Console.WriteLine($"All students passing? {allPassing}");
        
        // Any adult students?
        bool hasAdults = students.Any(s => s.Age >= 18);
        Console.WriteLine($"Any adults? {hasAdults}");
        
        // All grades above 60?
        bool allGradesAbove60 = students.All(s => s.Grades.All(g => g > 60));
        Console.WriteLine($"All grades above 60? {allGradesAbove60}");
    }
}`}
/>

### Distinct and ToList/ToArray

<CodeEditor 
  initialCode={`using System;
using System.Linq;
using System.Collections.Generic;

class Program
{
    static void Main()
    {
        var numbers = new List<int> { 1, 2, 2, 3, 3, 3, 4, 4, 5 };
        
        Console.WriteLine($"Original: {string.Join(", ", numbers)}");
        
        // Distinct - remove duplicates
        var unique = numbers.Distinct();
        Console.WriteLine($"Distinct: {string.Join(", ", unique)}");
        
        // LINQ queries are lazy - they don't execute until enumerated
        // Use ToList() or ToArray() to materialize
        var list = numbers.Where(n => n > 2).ToList();
        var array = numbers.Where(n => n > 2).ToArray();
        
        Console.WriteLine($"\\nAs List: {string.Join(", ", list)} (Count: {list.Count})");
        Console.WriteLine($"As Array: {string.Join(", ", array)} (Length: {array.Length})");
        
        // ToDictionary
        var words = new List<string> { "apple", "banana", "cherry" };
        var wordLengths = words.ToDictionary(w => w, w => w.Length);
        
        Console.WriteLine("\\nWord lengths:");
        foreach (var kvp in wordLengths)
        {
            Console.WriteLine($"  {kvp.Key}: {kvp.Value}");
        }
        
        // ToHashSet
        var uniqueSet = numbers.ToHashSet();
        Console.WriteLine($"\\nHashSet: {string.Join(", ", uniqueSet)}");
    }
}`}
/>

## Chaining Operations

<CodeEditor 
  initialCode={`using System;
using System.Linq;
using System.Collections.Generic;

class Product
{
    public string Name { get; set; }
    public string Category { get; set; }
    public decimal Price { get; set; }
    public int Stock { get; set; }
}

class Program
{
    static void Main()
    {
        var products = new List<Product>
        {
            new Product { Name = "Laptop", Category = "Electronics", Price = 999.99m, Stock = 10 },
            new Product { Name = "Mouse", Category = "Electronics", Price = 29.99m, Stock = 50 },
            new Product { Name = "Desk", Category = "Furniture", Price = 199.99m, Stock = 5 },
            new Product { Name = "Chair", Category = "Furniture", Price = 149.99m, Stock = 8 },
            new Product { Name = "Monitor", Category = "Electronics", Price = 299.99m, Stock = 0 },
            new Product { Name = "Lamp", Category = "Furniture", Price = 49.99m, Stock = 20 }
        };
        
        // Chain multiple operations
        var result = products
            .Where(p => p.Category == "Electronics")  // Filter by category
            .Where(p => p.Stock > 0)                  // In stock only
            .OrderByDescending(p => p.Price)          // Sort by price
            .Take(3)                                  // Top 3
            .Select(p => new { p.Name, p.Price });    // Project to simple object
        
        Console.WriteLine("Top 3 in-stock Electronics (by price):");
        foreach (var item in result)
        {
            Console.WriteLine($"  {item.Name}: \\${'{'}item.Price{'}'}");
        }
        
        // Another pipeline
        var summary = products
            .Where(p => p.Stock > 0)
            .GroupBy(p => p.Category)
            .Select(g => new
            {
                Category = g.Key,
                Count = g.Count(),
                TotalValue = g.Sum(p => p.Price * p.Stock),
                AvgPrice = g.Average(p => p.Price)
            })
            .OrderByDescending(x => x.TotalValue);
        
        Console.WriteLine("\\nInventory Summary by Category:");
        foreach (var cat in summary)
        {
            Console.WriteLine($"  {cat.Category}:");
            Console.WriteLine($"    Products: {cat.Count}");
            Console.WriteLine($"    Total Value: \\${'{'}cat.TotalValue:F2{'}'}");
            Console.WriteLine($"    Avg Price: \\${'{'}cat.AvgPrice:F2{'}'}");
        }
    }
}`}
/>

## Key Takeaways

- **LINQ** provides a unified way to query any data source
- **Method syntax** (fluent) and **query syntax** (SQL-like) are interchangeable
- **Where** filters, **Select** transforms, **OrderBy** sorts
- **First/Last/Single** get specific elements
- **Take/Skip** for pagination
- **Any/All** for boolean checks
- Operations are **lazy** until materialized with ToList/ToArray

## Best Practices

1. **Prefer method syntax** for most cases
2. **Chain operations** fluently for readability
3. **Use ToList()** when you need to materialize results
4. **Remember lazy evaluation** - queries execute when enumerated
5. **Use meaningful names** for lambda parameters

## Next Steps

Next lesson: **Advanced LINQ** - Learn GroupBy, Join, and complex queries!
